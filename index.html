<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Preset Modal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1e1e1e;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        input {
            width: 80%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            margin-bottom: 20px;
            transition: width 0.3s;
        }
        .presetModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }
        .presetList {
            background-color: #2e2e2e;
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
        }
        .presetButton {
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            margin: 5px 0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .loadingBar {
            width: 0;
            height: 5px;
            background-color: #4CAF50;
            transition: width 0.35s;
        }
        .loadingContainer {
            width: 80%;
            background-color: #555;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        .codeFlow {
            display: none;
            background-color: #2e2e2e;
            color: #ffffff;
            padding: 10px;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>

    <input type="text" id="urlInput" placeholder="Enter URL and press Tab" />
    <div class="loadingContainer">
        <div class="loadingBar" id="loadingBar"></div>
    </div>
    <div class="codeFlow" id="codeFlow"></div>
    <div class="presetModal" id="presetModal">
        <div class="presetList" id="presetList"></div>
    </div>

    <script>
        const presetSites = [
            { name: "Google", url: "https://www.google.com" },
            { name: "Facebook", url: "https://www.facebook.com" },
            { name: "Twitter", url: "https://www.twitter.com" }
        ];

        const urlInput = document.getElementById('urlInput');
        const presetModal = document.getElementById('presetModal');
        const presetList = document.getElementById('presetList');
        const loadingBar = document.getElementById('loadingBar');
        const codeFlow = document.getElementById('codeFlow');

        urlInput.addEventListener('keydown', function(event) {
            if (event.key === 'Tab') {
                event.preventDefault();
                const inputValue = urlInput.value.trim();
                if ((inputValue.startsWith('http://') || inputValue.startsWith('https://')) && presetSites.length > 0) {
                    openPresetModal(inputValue);
                } else {
                    alert('Please enter a valid full URL before viewing presets.');
                }
            }
        });

        function openPresetModal(inputValue) {
            presetList.innerHTML = '';
            presetSites.forEach(site => {
                const button = document.createElement('div');
                button.className = 'presetButton';
                button.innerText = site.name;
                button.onclick = function() {
                    urlInput.value = site.url;
                    closePresetModal();
                    startOpenSequence(site.url);
                };
                presetList.appendChild(button);
            });
            presetModal.style.display = 'flex';
        }

        function closePresetModal() {
            presetModal.style.display = 'none';
        }

        function startOpenSequence(url) {
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                alert('Invalid URL');
                return;
            }
            urlInput.disabled = true;
            urlInput.style.opacity = '0.3';
            loadingBar.style.width = '0%';
            let barIndex = 0;

            function fillNextBar() {
                if (barIndex >= 1) {
                    showFinalLoading(url);
                } else {
                    loadingBar.style.width = '100%';
                    barIndex++;
                    setTimeout(fillNextBar, 350);
                }
            }
            fillNextBar();
        }

        function showFinalLoading(url) {
            loadingBar.style.width = '100%';
            setTimeout(() => {
                openIframeWindow(url);
                resetUI();
            }, 1800);
        }

        function resetUI() {
            urlInput.disabled = false;
            urlInput.style.opacity = '1';
            urlInput.value = '';
            loadingBar.style.width = '0%';
            closePresetModal();
            codeFlow.innerHTML = '';
        }

        function openIframeWindow(url) {
            const newWindow = window.open('about:blank', '_blank');
            newWindow.document.write(`
                <html>
                <head>
                    <title>Embedded Console</title>
                    <style>
                        body { margin: 0; }
                        iframe { width: 100vw; height: 100vh; border: none; }
                        .console { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0, 0, 0, 0.8); color: white; padding: 10px; }
                    </style>
                </head>
                <body>
                    <iframe src="${url}"></iframe>
                    <div class="console" id="console">
                        <input type="text" id="codeInput" placeholder="Enter JS command" />
                    </div>
                    <script>
                        const codeInput = document.getElementById('codeInput');
                        codeInput.addEventListener('keypress', function(event) {
                            if (event.key === 'Enter') {
                                try {
                                    const result = eval(codeInput.value);
                                    console.log(result);
                                } catch (error) {
                                    console.error(error);
                                }
                                codeInput.value = '';
                            }
                        });
                    </script>
                </body>
                </html>
            `);
            newWindow.document.close();
        }
    </script>
</body>
</html>
