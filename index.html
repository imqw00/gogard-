<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Preset Modal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        #urlInput {
            width: 80%;
            padding: 10px;
            border: 1px solid #ffffff;
            border-radius: 5px;
            background-color: #1e1e1e;
            color: #ffffff;
        }
        #presetModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }
        .presetButton {
            background-color: #3a3a3a;
            color: #ffffff;
            padding: 10px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .loadingBar {
            width: 0;
            height: 5px;
            background-color: #4caf50;
            transition: width 0.35s;
        }
        #codeFlow {
            display: none;
            background-color: #1e1e1e;
            color: #ffffff;
            padding: 10px;
            border-radius: 5px;
            overflow-y: auto;
            max-height: 200px;
        }
    </style>
</head>
<body>

    <input type="text" id="urlInput" placeholder="Enter URL and press Tab" />
    <div id="loadingBars">
        <div class="loadingBar"></div>
        <div class="loadingBar"></div>
        <div class="loadingBar"></div>
    </div>
    <div id="presetModal">
        <div id="presetList"></div>
        <button onclick="closePresetModal()">Close</button>
    </div>
    <pre id="codeFlow"></pre>

    <script>
        const presetSites = [
            { name: "Google", url: "https://www.google.com" },
            { name: "Facebook", url: "https://www.facebook.com" },
            { name: "Twitter", url: "https://www.twitter.com" }
        ];

        document.getElementById('urlInput').addEventListener('keydown', function(event) {
            if (event.key === 'Tab') {
                event.preventDefault();
                const inputValue = this.value.trim();
                if ((inputValue.startsWith('http://') || inputValue.startsWith('https://')) && presetSites.length > 0) {
                    const matchingSites = presetSites.filter(site => site.url.startsWith(inputValue));
                    if (matchingSites.length > 0) {
                        openPresetModal(matchingSites);
                    } else {
                        alert('Please enter a valid full URL before viewing presets.');
                    }
                }
            }
        });

        function openPresetModal(matchingSites) {
            const presetList = document.getElementById('presetList');
            presetList.innerHTML = '';
            matchingSites.forEach(site => {
                const button = document.createElement('div');
                button.className = 'presetButton';
                button.innerText = site.name;
                button.onclick = () => {
                    document.getElementById('urlInput').value = site.url;
                    closePresetModal();
                    startOpenSequence(site.url);
                };
                presetList.appendChild(button);
            });
            document.getElementById('presetModal').style.display = 'flex';
        }

        function closePresetModal() {
            document.getElementById('presetModal').style.display = 'none';
        }

        function startOpenSequence(url) {
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                alert('Invalid URL!');
                return;
            }
            document.getElementById('urlInput').disabled = true;
            document.getElementById('urlInput').style.opacity = 0.3;
            resetLoadingBars();
            fillNextBar(url);
        }

        function resetLoadingBars() {
            const bars = document.querySelectorAll('.loadingBar');
            bars.forEach(bar => bar.style.width = '0%');
        }

        let barIndex = 0;
        function fillNextBar(url) {
            const bars = document.querySelectorAll('.loadingBar');
            if (barIndex < bars.length) {
                bars[barIndex].style.width = '100%';
                barIndex++;
                setTimeout(() => fillNextBar(url), 350);
            } else {
                showFinalLoading(url);
            }
        }

        function showFinalLoading(url) {
            setTimeout(() => {
                openIframeWindow(url);
            }, 1800);
        }

        function openIframeWindow(url) {
            const newWindow = window.open();
            newWindow.document.write(`
                <!DOCTYPE html>
                <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <title>Embedded Console</title>
                    <style>
                        body { margin: 0; }
                        iframe { width: 100%; height: 100vh; border: none; }
                        #codeInput { position: fixed; bottom: 0; width: 100%; }
                    </style>
                </head>
                <body>
                    <iframe src="${url}"></iframe>
                    <input type="text" id="codeInput" placeholder="Enter JavaScript command" />
                    <div id="codeFlow" style="display: none;"></div>
                    <script>
                        document.getElementById('codeInput').addEventListener('keydown', function(event) {
                            if (event.key === 'Enter') {
                                const command = this.value;
                                try {
                                    const result = eval(command);
                                    console.log(result);
                                } catch (error) {
                                    console.error(error);
                                }
                                this.value = '';
                            }
                        });
                    </script>
                </body>
                </html>
            `);
            newWindow.document.close();
            resetUI();
        }

        function resetUI() {
            document.getElementById('urlInput').disabled = false;
            document.getElementById('urlInput').style.opacity = 1;
            document.getElementById('urlInput').value = '';
            barIndex = 0;
            resetLoadingBars();
        }
    </script>
</body>
</html>
